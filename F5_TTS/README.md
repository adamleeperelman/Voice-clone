# F5-TTS Voice Cloning Module 🎤

A complete F5-TTS implementation for voice cloning using the voice samples generated by the Voice AI Separator.

## Features

- 🎯 **Voice Loading**: Automatically loads voice samples from `ai_voice_samples/`
- 🤖 **F5-TTS Integration**: Uses state-of-the-art F5-TTS for voice cloning
- 🔄 **Fallback Mode**: Works even without F5-TTS installed (mock mode)
- 🎛️ **Simple API**: Easy-to-use interface for text-to-speech generation
- 🗣️ **Interactive Mode**: Interactive voice cloning session

## Quick Start

### 1. Generate Voice Samples First

```bash
# From the main directory
python voice_ai_separator.py "Raw Sample/recording.mp3"
```

This creates voice samples in `ai_voice_samples/left_speaker/` and `ai_voice_samples/right_speaker/`.

### 2. Install F5-TTS Dependencies

```bash
cd F5_TTS
python setup.py
```

### 3. Run the Example

```bash
python example.py
```

## Usage Examples

### Basic Usage

```python
from F5_TTS.voice_cloner import VoiceCloner

# Initialize cloner
cloner = VoiceCloner(voice_samples_dir="../ai_voice_samples")

# List available voices
voices = cloner.list_voices()
print(f"Available voices: {voices}")

# Set voice
cloner.set_voice("left")  # or "right"

# Generate speech
audio = cloner.generate_speech(
    text="Hello, this is a test of voice cloning!",
    output_path="generated_speech.wav"
)
```

### Interactive Mode

```python
cloner = VoiceCloner()
cloner.clone_voice_interactive()
```

### Advanced Usage

```python
# Use specific voice with custom reference
cloner.set_voice("left", reference_sample="AI_001_8.3s_q7.wav")

# Generate with speed control
audio = cloner.generate_speech(
    text="This will be spoken faster",
    speed=1.2,
    output_path="fast_speech.wav"
)
```

## API Reference

### VoiceCloner Class

#### `__init__(voice_samples_dir, device="auto")`
- `voice_samples_dir`: Directory containing voice samples
- `device`: Device to use ('cpu', 'cuda', 'mps', or 'auto')

#### `list_voices() -> List[str]`
Returns list of available voice names.

#### `set_voice(voice_name, reference_sample=None)`
- `voice_name`: Name of voice to use ("left" or "right")
- `reference_sample`: Specific sample file to use as reference

#### `generate_speech(text, voice_name=None, speed=1.0, output_path=None)`
- `text`: Text to synthesize
- `voice_name`: Voice to use (optional if already set)
- `speed`: Speech speed multiplier (1.0 = normal)
- `output_path`: Path to save audio file (optional)

Returns: Audio array or path to saved file

#### `clone_voice_interactive()`
Starts interactive voice cloning session.

## Installation Details

### Method 1: Automatic Setup
```bash
python setup.py
```

### Method 2: Manual Installation
```bash
# Install core dependencies
pip install torch torchaudio numpy librosa soundfile pydub

# Try to install F5-TTS
pip install f5-tts
# OR
pip install git+https://github.com/SWivid/F5-TTS.git
```

## File Structure

```
F5_TTS/
├── __init__.py           # Module initialization
├── voice_cloner.py       # Main VoiceCloner class
├── model.py             # F5TTS model wrapper
├── example.py           # Usage examples
├── setup.py             # Installation script
├── requirements.txt     # Python dependencies
└── README.md           # This file
```

## Expected Input Structure

The voice cloner expects voice samples in this structure:

```
ai_voice_samples/
├── left_speaker/
│   ├── AI_001_8.3s_q7.wav
│   ├── AI_002_8.1s_q7.wav
│   └── ...
├── right_speaker/
│   ├── AI_001_11.9s_q7.wav
│   ├── AI_002_13.8s_q7.wav
│   └── ...
└── analysis/
    ├── left_analysis.json
    └── right_analysis.json
```

## Generated Output

When you run the voice cloner, it creates:

```
generated_speech/
├── speech_left_001.wav
├── speech_left_002.wav
├── example_01_left.wav
└── ...
```

## Troubleshooting

### F5-TTS Not Available
If F5-TTS cannot be installed, the system will use a fallback mode that:
- Still loads and analyzes voice samples
- Returns reference audio instead of generated speech
- Provides all the same API functionality

### CUDA/GPU Issues
```python
# Force CPU usage
cloner = VoiceCloner(device="cpu")
```

### Audio Format Issues
The system automatically handles various audio formats through librosa and torchaudio.

### No Voice Samples Found
Make sure you've run the voice separator first:
```bash
python voice_ai_separator.py "your_audio_file.mp3"
```

## Performance Notes

- **GPU Recommended**: F5-TTS works much faster with CUDA or Apple Metal
- **Memory Usage**: Large models may require 4GB+ GPU memory
- **Generation Time**: Typically 2-10 seconds per sentence
- **Quality**: Depends on reference sample quality and length

## Advanced Configuration

### Custom Model Path
```python
from F5_TTS.model import F5TTSModel

model = F5TTSModel(model_path="path/to/custom/model.pth")
cloner = VoiceCloner()
cloner.model = model
```

### Batch Processing
```python
texts = ["First sentence.", "Second sentence.", "Third sentence."]
for i, text in enumerate(texts):
    cloner.generate_speech(text, output_path=f"batch_{i:03d}.wav")
```

## Contributing

1. Fork the repository
2. Create a feature branch
3. Add your improvements
4. Test with different voice samples
5. Submit a pull request

## License

This module is part of the Voice Clone project. See main LICENSE file.

---

🎤 **Ready to clone voices with F5-TTS!** Start by generating samples with the voice separator, then use this module to create amazing voice clones.
